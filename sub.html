<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ALOS_ | AI Chatbot</title>

<style>
/* ===== Softer ChatGPT-Style UI ===== */
:root {
    --bg: #eef3ff;
    --container-bg: #f7f9ff;
    --panel: #eef2ff;
    --text: #0f172a;

    --user-msg: #2563eb;
    --user-text: #ffffff;

    --bot-msg: #ffffff;
    --border: rgba(15,23,42,0.08);
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    background: linear-gradient(180deg, #eef3ff, #ffffff);
    color: var(--text);
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    display: flex;
    justify-content: center;
    height: 100vh;
}

/* Container */
.container {
    width: 60%;
    display: flex;
    flex-direction: column;
    height: 100%;
    background: var(--container-bg);
}

@media (max-width: 768px) {
    .container { width: 100%; }
}

/* Header */
header {
    padding: 16px;
    font-size: 1.1rem;
    font-weight: 700;
    letter-spacing: 1px;
    border-bottom: 1px solid var(--border);
    text-align: center;
}

/* Chat Area */
#chat-window {
    flex: 1;
    padding: 24px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 22px;
}

/* Messages */
.message {
    max-width: 75%;
    padding: 16px 18px;
    border-radius: 14px;
    font-size: 0.95rem;
    line-height: 1.65;
}

/* User */
.user-message {
    align-self: flex-end;
    background: var(--user-msg);
    color: var(--user-text);
    border-bottom-right-radius: 6px;
}

/* Bot */
.bot-message {
    align-self: flex-start;
    background: var(--bot-msg);
    border: 1px solid var(--border);
    color: var(--text);
    border-bottom-left-radius: 6px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

/* Yellow headings */
.ai-heading {
    color: #facc15;
    font-weight: 700;
    display: block;
    margin: 12px 0 6px;
}

/* Input */
.input-container {
    border-top: 1px solid var(--border);
    padding: 16px;
    background: var(--panel);
}

textarea {
    width: 100%;
    background: #ffffff;
    border: 1px solid var(--border);
    color: var(--text);
    padding: 14px;
    border-radius: 12px;
    resize: none;
    outline: none;
    font-size: 0.95rem;
}

textarea::placeholder {
    color: #64748b;
}

button {
    margin-top: 10px;
    background: #2563eb;
    color: white;
    border: none;
    padding: 12px;
    border-radius: 12px;
    font-weight: 700;
    cursor: pointer;
}

button:disabled {
    opacity: 0.6;
}

/* Footer */
footer {
    font-size: 0.6rem;
    text-align: center;
    padding: 10px;
    opacity: 0.4;
}
</style>
</head>

<body>

<div class="container">
    <header>ALOS<span class="cursor">_</span></header>

    <div id="chat-window">
        <div class="message bot-message">
            <span class="ai-heading">Welcome</span>
            I am ALOS_. How can I assist you?
        </div>
    </div>

    <div class="input-container">
        <textarea id="userInput" rows="2" placeholder="Enter custom prompt here..."></textarea>
        <button id="sendBtn">Send Message</button>
    </div>

    <footer>FIREBASE | GEMINI AI</footer>
</div>

<script>
/* CONFIG */
const API_KEY = "AIzaSyAO0OfW34GELdDk1yjO3HDMFOzaPEQjNoI";
const MODEL = "gemini-2.5-flash";

const chatWindow = document.getElementById("chat-window");
const userInput = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");

/* Format AI text */
function formatAIText(text) {
    text = text.replace(/([a-z])([A-Z])/g, "$1 $2");
    text = text.replace(/\*\*(.*?)\*\*/g, '<span class="ai-heading">$1</span>');
    text = text.replace(/^\* (.*)$/gm, "â€¢ $1");
    text = text.replace(/\n+/g, "<br><br>");
    return text;
}

/* Add message */
function addMessage(text, className) {
    const div = document.createElement("div");
    div.className = `message ${className}`;
    div.innerHTML = className === "bot-message" ? formatAIText(text) : text;
    chatWindow.appendChild(div);
    chatWindow.scrollTop = chatWindow.scrollHeight;
    return div;
}

/* Typing effect with formatting */
async function typeWriter(element, text) {
    const formatted = formatAIText(text);
    element.innerHTML = "";
    for (let i = 0; i < formatted.length; i++) {
        element.innerHTML += formatted.charAt(i);
        chatWindow.scrollTop = chatWindow.scrollHeight;
        await new Promise(res => setTimeout(res, 10));
    }
}

/* Send message */
async function sendMessage() {
    const text = userInput.value.trim();
    if (!text) return;

    addMessage(text, "user-message");
    userInput.value = "";
    sendBtn.disabled = true;
    sendBtn.innerText = "THINKING...";

    const botBubble = addMessage("", "bot-message");

    try {
        const res = await fetch(
            `https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`,
            {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ parts: [{ text }] }]
                })
            }
        );

        const data = await res.json();
        const reply = data.candidates[0].content.parts[0].text;
        await typeWriter(botBubble, reply);

    } catch (err) {
        botBubble.innerText = "Error: " + err.message;
    } finally {
        sendBtn.disabled = false;
        sendBtn.innerText = "Send Message";
    }
}

/* Events */
sendBtn.addEventListener("click", sendMessage);
userInput.addEventListener("keydown", e => {
    if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
    }
});
</script>

</body>
</html>
